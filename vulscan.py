#!/bin/python3

import socket
import os
import sys


def vulns(ban, filename):
	f = open(filename, "r")
	for line in f.readlines():
		if line.strip("\n") in str(ban):
			print("[+] Server is vulnerable: " + str(ban).strip("\n"))

def rBan(ip, port):
	
	try:
		socket.setdefaulttimeout(2)
		s = socket.socket()
		s.connect((ip,port))
		banner = s.recv(1024)
		return banner
	except:
		return 
		

def main():
	if len(sys.argv) == 2:
		filename = sys.argv[1]
		
		if not os.access(filename, os.F_OK):
			print("[-] File Doesn't Exist or Invalid File Name")
			exit(0)
		if not os.access(filename, os.R_OK):
			print("[-] You do not have access to this file")
			exit(0)
	else:
		print("Usage: " + str(sys.argv[0]) + " <vulnerabilities file name>")
		exit(0)


	portlist = [20,21,22,25,80,110,123,135,443,445]
	for i in range(97, 100):
		ip = "192.168.86." + str(i)
		for port in portlist:
			banner = rBan(ip, port)
			if banner:
				print("[+]" + ip + "/" + str(port) + ": " + str(banner))
				vulns(banner, filename)
				#portscan(ip, port)
main()

